# Анонимные классы

Анонимный класс в Java — это **локальный класс без имени**, определяемый и создаваемый **одновременно**. Он используется для **однократной реализации интерфейса или наследования класса**, часто в качестве **обработчика событий, колбэка или вспомогательного поведения**.

---

### Где и как используется

Анонимные классы обычно объявляются:
- Внутри методов (чаще всего в `main` или при передаче в методы как аргумент),
- В блоках инициализации,
- В выражениях создания объекта (`new`),
- Для реализации **интерфейсов** или **расширения классов** на месте, **без объявления имени класса**.

---

### Синтаксис: реализация интерфейса или наследование класса

```java
SomeType obj = new SomeType() {
    // тело анонимного класса
};
```

- `SomeType` — это интерфейс или класс (чаще абстрактный).
- Внутри блока `{}` ты можешь переопределить методы интерфейса/родителя.
- Компилятор создаст **вспомогательный безымянный подкласс** с уникальным именем типа `Main$1`.

---

### Пример 1: реализация интерфейса

```java
interface Printable {
    void print();
}

public class Main {
    public static void main(String[] args) {
        Printable p = new Printable() {
            @Override
            public void print() {
                System.out.println("Печать из анонимного класса");
            }
        };
        p.print(); // Вызов метода
    }
}
```

---

### Пример 2: наследование от абстрактного класса

```java
abstract class Greeter {
    abstract void greet();
}

public class Main {
    public static void main(String[] args) {
        Greeter g = new Greeter() {
            @Override
            void greet() {
                System.out.println("Hello from anonymous class!");
            }
        };
        g.greet();
    }
}
```

---

### Пример 3: в аргументе метода

```java
button.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        System.out.println("Кнопка нажата!");
    }
});
```

---

### Особенности и ограничения

- ✅ **Можно**:
  - Переопределять методы интерфейсов или суперклассов.
  - Использовать локальные переменные из внешнего метода, **если они `final` или эффективно final**.
  - Объявлять поля, методы и блоки инициализации внутри тела анонимного класса.

- ❌ **Нельзя**:
  - Определить конструктор (у анонимного класса нет имени → нельзя вызывать `super(...)` с параметрами явно).
  - Расширять более одного класса/интерфейса.
  - Создать несколько экземпляров с разным поведением без дублирования.
  - Написать static методы или поля (разрешены только final static константы).

---

### Проблема, которую решают

Анонимные классы решают проблему **избыточности и захламления кода**, когда:
- Нужно реализовать интерфейс или абстрактный класс **однократно**;
- Нет смысла давать отдельное имя классу;
- Класс используется только **в одном месте**;
- Нужно сократить шаблонный, одноразовый код.

---

### Как компилируется

- Компилятор создает **внутренний класс**, обычно с именем вида:
  ```
  Main$1.class
  Main$2.class
  ```
  где `Main` — имя внешнего класса.
- Этот класс **наследует** или **реализует** нужный тип, и **имеет доступ ко всем final/эффективно final переменным внешнего окружения**.
